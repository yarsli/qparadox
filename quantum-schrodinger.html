<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QParadox • Quantum Mechanics — Schrödinger Equation</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet"/>

<!-- MathJax -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<style>
.quiz {
  margin-top:1.6rem; padding:1rem;
  border:1px solid var(--line);
  border-radius:14px;
  background:rgba(255,255,255,.04);
}

.qitem {
  margin:1.2rem 0; padding:1.2rem;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.25);
}

.qitem h4 {
  margin:0 0 .8rem 0;
  font-family:"Playfair Display",serif;
  font-size:1.1rem;
  color:var(--ink);
}

.qchoices {
  display:flex;
  flex-direction:column;
  gap:.6rem;
}

.qchoices button {
  width:100%;
  text-align:left;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(255,255,255,.06);
  color:var(--ink);
  padding:.8rem 1rem;
  border-radius:.6rem;
  cursor:pointer;
  font-size:1rem;
  transition:all .2s ease;
}

.qchoices button:hover:not(:disabled) {
  background:rgba(255,255,255,.12);
}

.qchoices button.correct {
  border-color:#46d17d;
  background:rgba(70,209,125,.15);
}

.qchoices button.wrong {
  border-color:#e07070;
  background:rgba(224,112,112,.15);
}

.qchoices button:disabled {
  opacity:.7;
  cursor:not-allowed;
}

.qfeedback {
  margin-top:.6rem;
  color:var(--ink2);
  font-size:.95rem;
}
:root{
  --bg:#0b0b0d; --panel:#131316; --ink:#efeae2; --ink2:#d8d1c8; --muted:#b9b3aa;
  --gold:#caa36b; --blue:#7aa0ff; --line:rgba(255,255,255,.14); --glass:rgba(255,255,255,.06);
  --shadow:0 18px 60px rgba(0,0,0,.72), inset 0 0 120px rgba(255,255,255,.03);
  --radius:18px; --side:330px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background:var(--bg); color:var(--ink);
  font-family:"Crimson Text",serif; line-height:1.95; letter-spacing:.15px; overflow-x:hidden;
}
body::before{content:""; position:fixed; inset:0; z-index:-3; opacity:.06;
  background:url('https://www.transparenttextures.com/patterns/asfalt-dark.png')}
body::after{content:""; position:fixed; inset:0; z-index:-2; pointer-events:none;
  background:
    radial-gradient(900px 520px at 12% 0%, rgba(255,222,180,.09), transparent 60%),
    radial-gradient(900px 520px at 88% 12%, rgba(140,160,255,.06), transparent 60%),
    radial-gradient(1000px 620px at 50% 100%, rgba(202,163,107,.07), transparent 70%)}

/* frame + progress */
.frame{position:fixed; inset:18px; border:1px solid var(--line); border-radius:22px; pointer-events:none; box-shadow:inset 0 0 140px rgba(0,0,0,.45)}
#progress{position:fixed; top:0; left:0; height:4px; width:0; z-index:100; background:linear-gradient(90deg,var(--gold),var(--blue)); box-shadow:0 0 10px rgba(202,163,107,.6)}

/* header */
header{padding:6.2rem 1.2rem 2.4rem; text-align:center}
h1{
  font-family:"Playfair Display",serif; font-weight:900; margin:0;
  font-size:clamp(2.6rem,4vw,4.8rem); line-height:1.1; color:#f5ead8; text-shadow:0 0 22px rgba(255,255,255,.12)
}
.subtitle{max-width:980px; margin:1rem auto 0; color:var(--ink2); font-size:clamp(1.05rem,1.2vw,1.2rem)}

/* layout */
.main{width:min(1200px,94%); margin:0 auto 4rem; display:grid; grid-template-columns:1fr; gap:26px}
@media(min-width:1120px){ .main{grid-template-columns:minmax(0, 1fr) var(--side)} }

/* article */
article{
  background:linear-gradient(180deg,rgba(255,255,255,.055),rgba(255,255,255,.03));
  border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); padding:2.2rem 1.2rem
}
@media(min-width:780px){ article{padding:2.6rem 2.2rem} }
article h2{font-family:"Playfair Display",serif; margin:2rem 0 1rem; font-size:clamp(1.85rem,2.6vw,2.5rem); color:#f6eddc}
.divider{height:1px; background:linear-gradient(90deg,transparent,var(--line),transparent); margin:1.2rem 0}
p{margin:1.05rem 0; text-align:justify}
.dropcap:first-letter{float:left; font-family:"Playfair Display",serif; font-size:3.2rem; line-height:2.3rem; padding:.25rem .5rem .2rem 0; color:#f3e4c5}

/* figures */
.figure{
  margin:1.5rem auto; border:1px solid var(--line); border-radius:14px; overflow:hidden;
  background:#0e0f12; box-shadow:var(--shadow); max-width:820px
}
.figure img{display:block; width:100%; height:auto}
.figcap{padding:.7rem .9rem; color:var(--ink2); font-size:.95rem; border-top:1px solid var(--line)}

/* highlight button */
.pwrap{position:relative; padding-right:2.5rem}
.hlbtn{
  position:absolute; right:.2rem; top:.35rem; padding:.25rem .6rem; border-radius:.6rem;
  background:var(--glass); color:var(--ink); border:1px solid var(--line);
  font-size:.85rem; cursor:pointer; opacity:0; transition:.2s
}
.pwrap:hover .hlbtn{opacity:1}
.mark{background:linear-gradient(180deg, rgba(202,163,107,.3), rgba(122,160,255,.24)); border-radius:.2rem; padding:.05rem .12rem}

/* sidebar */
aside{
  position:sticky; top:90px; align-self:start; height:fit-content;
  background:linear-gradient(180deg,rgba(255,255,255,.055),rgba(255,255,255,.03));
  border:1px solid var(--line); border-radius:16px; box-shadow:var(--shadow); padding:1rem .9rem
}
aside h3{margin:.2rem 0 .7rem; font-family:"Playfair Display",serif}
.toc a{display:block; text-decoration:none; color:var(--ink2); padding:.35rem .2rem; border-radius:.4rem; font-size:.95rem}
.toc a:hover{color:var(--ink)}
.toc a.active{color:#111; background:linear-gradient(90deg,var(--gold),#efd6a8)}
hr.sep{border:0; height:1px; background:linear-gradient(90deg,transparent,var(--line),transparent); margin:1rem 0}
.note{border:1px solid var(--line); border-radius:12px; padding:.7rem .75rem; margin:.5rem 0; background:rgba(255,255,255,.05)}
.note time{display:block; color:var(--muted); font-size:.85rem}
.note .del{margin-top:.4rem; padding:.25rem .55rem; border-radius:.5rem; border:1px solid var(--line); background:var(--glass); color:var(--ink); cursor:pointer}
</style>
</head>
<body>

<div class="frame" aria-hidden="true"></div>
<div id="progress"></div>

<header class="reveal in">
  <h1>Quantum Mechanics — Schrödinger Equation</h1>
  <p class="subtitle">The equation that made quantum mechanics a predictive science: a wave equation not for water or sound, but for the very probabilities that shape reality.</p>
</header>

<div class="main">
  <!-- ARTICLE -->
  <article id="article">

    <h2 id="foundations" class="reveal">Foundations of Schrödinger Mechanics</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p1">★ Highlight</button>
      <p id="p1" class="dropcap">
        At the dawn of the twentieth century, physicists confronted phenomena classical physics could not explain: atomic spectra, blackbody radiation, and the stability of matter itself. Out of this crisis emerged the quantum hypothesis, first suggested by Planck and expanded by Einstein. Yet it was Erwin Schrödinger, in 1926, who gave the new physics its central mathematical tool: a differential equation describing how a quantum state evolves in time. This <em>Schrödinger equation</em> transformed quantum theory from a patchwork of ideas into a unified framework.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p2">★ Highlight</button>
      <p id="p2">
        Unlike Newton’s laws, which predict precise trajectories, the Schrödinger equation predicts the <em>wavefunction</em>, \( \psi(\vec{r},t) \). This complex function does not tell us directly where a particle is, but rather encodes probabilities. The squared magnitude, \( |\psi|^2 \), gives the likelihood of finding the particle in a region of space at a given time. Thus, reality in quantum mechanics is not about certainty but about distributions, shaped by boundary conditions and initial states.
      </p>
    </div>
    <h2 id="equations" class="reveal">The Time-Dependent and Time-Independent Equations</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p3">★ Highlight</button>
      <p id="p3" class="dropcap">
        The full dynamical law of quantum mechanics is the <strong>time-dependent Schrödinger equation</strong>:
        \[
        i \hbar \frac{\partial}{\partial t} \psi(\vec{r},t) \;=\; \hat{H}\,\psi(\vec{r},t).
        \]
        Here \( i \) is the imaginary unit, \( \hbar \) is Planck’s constant divided by \( 2\pi \), and \( \hat{H} \) is the Hamiltonian operator encoding the total energy. This equation says that time evolution of a system is governed not by forces and accelerations, but by the action of the Hamiltonian on the state vector.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p4">★ Highlight</button>
      <p id="p4">
        In many systems of interest, especially stationary ones, the Hamiltonian does not depend explicitly on time. In such cases, we can look for solutions of the form 
        \(\psi(\vec{r},t) = \phi(\vec{r}) e^{-iEt/\hbar}\).
        Substituting this into the time-dependent equation yields the <strong>time-independent Schrödinger equation</strong>:
        \[
        \hat{H}\,\phi(\vec{r}) \;=\; E \,\phi(\vec{r}),
        \]
        which is an eigenvalue problem. The allowed energies \(E\) are quantized, and the corresponding eigenfunctions \(\phi(\vec{r})\) describe stationary states. This form underlies much of quantum chemistry and solid-state physics.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p5">★ Highlight</button>
      <p id="p5">
        The transition from Newton’s laws to Schrödinger’s wave mechanics is profound. Instead of predicting a particle’s position, we predict the evolution of a <em>probability amplitude</em>. This amplitude interferes, diffracts, and superposes like a classical wave, yet always collapses to a definite measurement outcome. In this way, Schrödinger’s equation bridges determinism at the level of evolution with indeterminacy at the level of observation.
      </p>
    </div>

    <figure class="figure reveal">
      <img src="schrodinger-wave.png" alt="Visualization of a quantum wavefunction evolving in time"/>
      <figcaption class="figcap">The time evolution of a Gaussian wave packet under the Schrödinger equation. Spreading reflects uncertainty in momentum and position.</figcaption>
    </figure>
    <h2 id="applications" class="reveal">Applications of the Schrödinger Equation</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p6">★ Highlight</button>
      <p id="p6" class="dropcap">
        The simplest nontrivial application of the Schrödinger equation is the <strong>particle in a box</strong>. Imagine a particle confined between two impenetrable walls a distance \(L\) apart. Classically, the particle could take any energy, bouncing back and forth freely. Quantum mechanically, however, the boundary conditions require that the wavefunction vanish at the walls. This constraint leads to discrete standing waves, with allowed energies
        \[
        E_n = \frac{n^2 \pi^2 \hbar^2}{2mL^2}, \quad n=1,2,3,\dots
        \]
        Only certain wavelengths “fit” in the box, and thus only certain energies are possible. This simple example illustrates the essential feature of quantization.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p7">★ Highlight</button>
      <p id="p7">
        Another iconic example is the <strong>quantum harmonic oscillator</strong>, a model for vibrations in atoms and molecules. Its Hamiltonian is
        \[
        \hat{H} = \frac{\hat{p}^2}{2m} + \tfrac{1}{2} m \omega^2 \hat{x}^2,
        \]
        with solutions that yield equally spaced energy levels:
        \[
        E_n = \hbar \omega \left(n + \tfrac{1}{2}\right).
        \]
        Unlike a classical oscillator, the quantum system cannot have zero energy; its lowest state still carries a “zero-point energy” of \(\tfrac{1}{2}\hbar\omega\). This reflects the unavoidable fluctuations imposed by the uncertainty principle.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p8">★ Highlight</button>
      <p id="p8">
        Perhaps most striking is <strong>quantum tunneling</strong>. When a particle encounters a barrier higher than its classical energy, Newtonian physics predicts it must reflect. Quantum mechanics, however, assigns a finite probability for the particle to appear on the other side. The wavefunction decays exponentially inside the barrier but can emerge beyond it. Tunneling underlies phenomena ranging from alpha decay in nuclear physics to the operation of tunnel diodes and scanning tunneling microscopes. It demonstrates vividly that particles are never just particles—they are waves with amplitudes that seep into classically forbidden regions.
      </p>
    </div>

    <figure class="figure reveal">
      <img src="quantum-tunneling.png" alt="Illustration of quantum tunneling through a potential barrier"/>
      <figcaption class="figcap">In quantum tunneling, part of the wavefunction penetrates the barrier, creating a nonzero probability of transmission.</figcaption>
    </figure>
    <h2 id="probability" class="reveal">Probability and Uncertainty</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p9">★ Highlight</button>
      <p id="p9" class="dropcap">
        The wavefunction is not a physical wave of matter but a wave of <strong>probability amplitude</strong>. Max Born proposed that the probability density of finding a particle at position \(\vec{r}\) and time \(t\) is
        \[
        P(\vec{r},t) = |\psi(\vec{r},t)|^2.
        \]
        This interpretation solved the riddle of what Schrödinger’s \(\psi\) actually means. It is not an observable itself, but a tool for predicting outcomes. Measurements extract information probabilistically, and repeated experiments reveal the statistical law encoded in \(|\psi|^2\).
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p10">★ Highlight</button>
      <p id="p10">
        A direct consequence of the wave nature of particles is the <strong>uncertainty principle</strong>. Position and momentum cannot both be known with arbitrary precision. Mathematically, this emerges from the Fourier relationship between a wave’s spread in space and in momentum:
        \[
        \Delta x \,\Delta p \;\geq\; \frac{\hbar}{2}.
        \]
        The sharper we try to localize a particle in space, the more uncertain its momentum becomes, and vice versa. This principle is not a matter of experimental limitation but a fundamental property of nature.
      </p>
    </div>

    <h2 id="operators" class="reveal">Operators and Hilbert Space</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p11">★ Highlight</button>
      <p id="p11" class="dropcap">
        In quantum mechanics, observables like position, momentum, and energy are represented not by numbers but by <strong>operators</strong> acting on wavefunctions. For example:
        \[
        \hat{x}\psi(x) = x\psi(x), \quad \hat{p}\psi(x) = -i\hbar \frac{d}{dx}\psi(x).
        \]
        The Hamiltonian itself is an operator, built from momentum and potential energy terms. Solving Schrödinger’s equation is thus finding the eigenvalues and eigenfunctions of operators, which correspond to measurable quantities and their possible outcomes.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p12">★ Highlight</button>
      <p id="p12">
        All quantum states exist in a structured mathematical space called a <strong>Hilbert space</strong>. This is a complete vector space with an inner product, allowing us to compute overlaps, norms, and orthogonality. Superposition—the ability to combine quantum states linearly—is a natural feature of Hilbert space. Orthogonal states represent mutually exclusive measurement outcomes, while completeness ensures that all possible states of a system can be expanded in a suitable basis. The abstract elegance of Hilbert space provides a foundation for both the philosophy and the practical computation of quantum mechanics.
      </p>
    </div>

    <figure class="figure reveal">
      <img src="uncertainty.png" alt="Heisenberg uncertainty principle illustration"/>
      <figcaption class="figcap">Wavepackets that are narrow in space spread in momentum, embodying Heisenberg’s uncertainty principle.</figcaption>
    </figure>
    <h2 id="measurement" class="reveal">Measurement and Collapse</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p13">★ Highlight</button>
      <p id="p13" class="dropcap">
        Quantum mechanics introduces a radical departure from classical determinism in the act of <strong>measurement</strong>. The Schrödinger equation predicts a smooth, deterministic evolution of the wavefunction. Yet when an observation is made, the system appears to “collapse” into a definite outcome. If a particle’s state is a superposition of left and right, a measurement forces it to appear in one position or the other. This postulate of collapse is not derived from the Schrödinger equation itself—it is an additional rule, necessary to connect theory with the experience of definite outcomes.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p14">★ Highlight</button>
      <p id="p14">
        The collapse is inherently probabilistic. The chance of observing a particular result is given by the squared amplitude of that component of the wavefunction. This is why quantum theory does not allow us to predict exact outcomes, only probabilities. Two identical experiments, prepared in the same state, may yield different results. Over many trials, the frequencies converge with the predictions of \(|\psi|^2\), vindicating the statistical nature of the quantum world.
      </p>
    </div>

    <h2 id="superposition" class="reveal">Superposition and Entanglement</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p15">★ Highlight</button>
      <p id="p15" class="dropcap">
        One of the most counterintuitive yet central features of quantum mechanics is <strong>superposition</strong>. A quantum system can exist in multiple states simultaneously until measured. A photon, for example, can traverse two slits at once, interfering with itself. This principle underlies interference experiments and gives quantum mechanics its extraordinary richness. When systems interact, their superpositions can intertwine, creating <strong>entanglement</strong>. In an entangled pair, measuring one particle instantaneously influences the state of the other, regardless of distance. This “spooky action at a distance,” as Einstein called it, has been experimentally verified and forms the backbone of quantum information science.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p16">★ Highlight</button>
      <p id="p16">
        Entanglement defies classical intuitions about locality and separability. Two particles that once interacted cannot be described independently—their joint wavefunction encodes correlations that persist even when they are light-years apart. Such correlations cannot be explained by hidden variables without violating Bell’s inequalities, which experiments have repeatedly confirmed. Entanglement is not a paradoxical artifact but a real resource, now harnessed in quantum cryptography, teleportation, and the race toward quantum computing.
      </p>
    </div>

    <h2 id="interpretations" class="reveal">Interpretations of Quantum Mechanics</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p17">★ Highlight</button>
      <p id="p17" class="dropcap">
        The dual structure of quantum theory—a deterministic wave equation and a probabilistic collapse rule—has inspired a spectrum of <strong>interpretations</strong>. The Copenhagen interpretation, advanced by Bohr and Heisenberg, emphasizes the primacy of measurement: quantum states are not physical objects but tools for predicting outcomes. The Many-Worlds interpretation, on the other hand, eliminates collapse by suggesting that every possible outcome occurs in a branching multiverse. Objective-collapse theories propose that the wavefunction spontaneously localizes under certain conditions, unifying dynamics and measurement. Pilot-wave theory restores determinism by positing hidden variables that guide particle motion along trajectories.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="p18">★ Highlight</button>
      <p id="p18">
        No consensus exists on which interpretation reflects reality. What is clear is that the mathematics of quantum mechanics works with unparalleled accuracy. Whether collapse is real, worlds multiply, or hidden variables remain, the predictions remain the same. This coexistence of mathematical certainty and philosophical mystery gives quantum mechanics its uniquely fascinating character: a theory at once predictive and enigmatic, practical and metaphysical.
      </p>
    </div>

    <figure class="figure reveal">
      <img src="double-slit.png" alt="Electron double-slit experiment interference pattern"/>
      <figcaption class="figcap">The double-slit experiment: single electrons build an interference pattern, dramatizing superposition and measurement collapse.</figcaption>
    </figure>
    <!-- Quiz -->
    <h2 id="quiz" class="reveal">Quick Quiz</h2>
    <div class="divider"></div>
    <section class="quiz reveal" id="quizSection">

      <div class="qitem">
        <h4>1) What does the Schrödinger equation fundamentally describe?</h4>
        <div class="qchoices" data-answer="b" data-explain="It governs the time evolution of the wavefunction, encoding how quantum probabilities change.">
          <button data-choice="a">Exact particle trajectories</button>
          <button data-choice="b">The evolution of the wavefunction over time</button>
          <button data-choice="c">Only the energy of classical oscillators</button>
        </div>
        <div class="qfeedback" aria-live="polite"></div>
      </div>

      <div class="qitem">
        <h4>2) Why are the energy levels of a particle in a box quantized?</h4>
        <div class="qchoices" data-answer="a" data-explain="Boundary conditions only allow standing waves with discrete wavelengths, leading to quantized energies.">
          <button data-choice="a">Only certain standing waves satisfy boundary conditions</button>
          <button data-choice="b">The particle loses energy at the walls</button>
          <button data-choice="c">The box randomly shifts the particle’s state</button>
        </div>
        <div class="qfeedback" aria-live="polite"></div>
      </div>

      <div class="qitem">
        <h4>3) What does the uncertainty principle state?</h4>
        <div class="qchoices" data-answer="c" data-explain="The product of uncertainties in position and momentum is bounded by ħ/2.">
          <button data-choice="a">We lack the right technology to measure precisely</button>
          <button data-choice="b">Uncertainty comes only from experimental errors</button>
          <button data-choice="c">Position and momentum cannot both be known exactly</button>
        </div>
        <div class="qfeedback" aria-live="polite"></div>
      </div>

    </section>
    <div class="nextrow reveal">
      <a href="quantum_mechanics.html">← Back to Quantum Mechanics Hub</a>
      <a href="quantum-heisenberg.html">Next page → Heisenberg Picture</a>
    </div>

  </article>

  <!-- Sidebar -->
  <aside class="reveal">
    <h3>Contents</h3>
    <div id="toc" class="toc"></div>
    <hr class="sep"/>
    <h3>Notebook</h3>
    <p style="color:var(--ink2); margin:.1rem 0 .6rem">Click ★ next to any paragraph to save it here.</p>
    <div id="nbList"></div>
  </aside>
</div>

<footer>© 2025 QParadox</footer>

<script>
/* progress bar */
const bar=document.getElementById('progress');
function onScroll(){
  const h=document.documentElement, st=h.scrollTop||document.body.scrollTop, sh=h.scrollHeight-h.clientHeight;
  bar.style.width=(Math.max(0,Math.min(1,st/sh))*100)+'%';
}
addEventListener('scroll', onScroll); onScroll();

/* reveal on scroll */
const obs=new IntersectionObserver(es=>{
  es.forEach(e=>{
    if(e.isIntersecting){
      e.target.classList.add('in');
      obs.unobserve(e.target);
    }
  });
},{threshold:.18});
document.querySelectorAll('.reveal').forEach(el=>{
  if(!el.classList.contains('in')) obs.observe(el);
});

/* TOC */
const toc=document.getElementById('toc');
const heads=[...document.querySelectorAll('#article h2')];
heads.forEach(h=>{
  const a=document.createElement('a');
  a.href='#'+h.id;
  a.textContent=h.textContent;
  toc.appendChild(a);
});
function spy(){
  const y=scrollY+140; let idx=-1;
  heads.forEach((s,i)=>{ if(s.offsetTop<=y && s.offsetTop+s.offsetHeight>y) idx=i; });
  [...toc.querySelectorAll('a')].forEach((a,i)=>a.classList.toggle('active',i===idx));
}
addEventListener('scroll', spy); spy();

/* notebook */
const KEY='qpx_notes_quantum_schrodinger';
const listEl=document.getElementById('nbList');
function load(){ try{return JSON.parse(localStorage.getItem(KEY)||'[]');}catch(e){return []}}
function save(data){ localStorage.setItem(KEY, JSON.stringify(data)); }
function render(){
  const notes=load(); listEl.innerHTML='';
  if(notes.length===0){
    listEl.innerHTML='<p style="color:var(--muted)">No highlights yet.</p>'; return;
  }
  notes.forEach(n=>{
    const div=document.createElement('div'); div.className='note'; div.dataset.id=n.id;
    div.innerHTML=`<time>${new Date(n.time).toLocaleString()}</time><p>${n.text}</p><button class="del">Remove</button>`;
    listEl.appendChild(div);
  });
}
render();
document.querySelectorAll('.hlbtn').forEach(btn=>{
  btn.addEventListener('click',()=>{
    const id=btn.dataset.target, p=document.getElementById(id);
    if(!p) return;
    p.classList.add('mark');
    const notes=load();
    notes.push({id:'n'+Date.now(), text:p.textContent.trim(), time:Date.now(), para:id});
    save(notes); render();
  });
});
listEl.addEventListener('click',e=>{
  if(!e.target.classList.contains('del')) return;
  const id=e.target.closest('.note').dataset.id;
  const notes=load().filter(x=>x.id!==id); save(notes); render();
});
</script>
</body>
</html>

