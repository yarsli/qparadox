<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QParadox • Quantum Next</title>

<!-- Same fonts and vibe as your other long pages -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet"/>

<!-- MathJax enabled locally on this page -->
<script async id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<style>
:root{
  --bg:#0b0b0d; --panel:#131316; --ink:#efeae2; --ink2:#d8d1c8; --muted:#b9b3aa;
  --gold:#caa36b; --blue:#7aa0ff; --line:rgba(255,255,255,.14); --glass:rgba(255,255,255,.06);
  --shadow:0 18px 60px rgba(0,0,0,.72), inset 0 0 120px rgba(255,255,255,.03);
  --radius:18px; --max:1180px; --side:330px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background:var(--bg); color:var(--ink);
  font-family:"Crimson Text",serif; line-height:1.95; letter-spacing:.15px; overflow-x:hidden;
}
body::before{content:""; position:fixed; inset:0; z-index:-3; opacity:.06;
  background:url('https://www.transparenttextures.com/patterns/asfalt-dark.png')}
body::after{content:""; position:fixed; inset:0; z-index:-2;
  background:
    radial-gradient(900px 520px at 12% 0%, rgba(255,222,180,.09), transparent 60%),
    radial-gradient(900px 520px at 88% 12%, rgba(140,160,255,.06), transparent 60%),
    radial-gradient(1000px 620px at 50% 100%, rgba(202,163,107,.07), transparent 70%)}

.frame{position:fixed; inset:18px; border:1px solid var(--line); border-radius:22px; pointer-events:none; box-shadow:inset 0 0 140px rgba(0,0,0,.45)}
#progress{position:fixed; top:0; left:0; height:4px; width:0; z-index:100; background:linear-gradient(90deg,var(--gold),var(--blue))}

header{padding:6.2rem 1.2rem 2.4rem; text-align:center}
h1{font-family:"Playfair Display",serif; font-weight:900; margin:0; font-size:clamp(2.6rem,4vw,4.8rem); line-height:1.1; color:#f5ead8}
.subtitle{max-width:980px; margin:1rem auto 0; color:var(--ink2); font-size:clamp(1.05rem,1.2vw,1.2rem)}

.main{width:min(1200px,94%); margin:0 auto 4rem; display:grid; grid-template-columns:1fr; gap:26px}
@media(min-width:1120px){ .main{grid-template-columns:minmax(0, 1fr) var(--side)} }

article{
  background:linear-gradient(180deg,rgba(255,255,255,.055),rgba(255,255,255,.03));
  border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); padding:2.6rem 2.2rem
}
article h2{font-family:"Playfair Display",serif; margin:2rem 0 1rem; font-size:clamp(1.85rem,2.6vw,2.5rem); color:#f6eddc}
.divider{height:1px; background:linear-gradient(90deg,transparent,var(--line),transparent); margin:1.2rem 0}
p{margin:1.05rem 0; text-align:justify}
.dropcap:first-letter{float:left; font-family:"Playfair Display",serif; font-size:3.2rem; line-height:2.3rem; padding:.25rem .5rem .2rem 0; color:#f3e4c5}

/* callouts */
.call{border:1px solid var(--line); border-radius:12px; background:rgba(255,255,255,.05); padding:.85rem .9rem; color:var(--ink2); margin:1rem 0}

/* figures */
.figure{margin:1.5rem auto; border:1px solid var(--line); border-radius:14px; overflow:hidden; background:#0e0f12; box-shadow:var(--shadow); max-width:820px}
.figure img{display:block; width:100%; height:auto}
.figcap{padding:.7rem .9rem; color:var(--ink2); font-size:.95rem; border-top:1px solid var(--line)}

/* paragraph highlight button */
.pwrap{position:relative; padding-right:2.5rem}
.hlbtn{
  position:absolute; right:.2rem; top:.35rem; padding:.25rem .6rem; border-radius:.6rem;
  background:var(--glass); color:var(--ink); border:1px solid var(--line);
  font-size:.85rem; cursor:pointer; opacity:0; transition:.2s
}
.pwrap:hover .hlbtn{opacity:1}
.mark{background:linear-gradient(180deg, rgba(202,163,107,.3), rgba(122,160,255,.24)); border-radius:.2rem; padding:.05rem .12rem}

/* collapsible worked examples */
details{border:1px solid var(--line); border-radius:12px; padding:.7rem .9rem; background:rgba(255,255,255,.04); margin:1rem 0}
details summary{cursor:pointer; font-family:"Playfair Display",serif; font-size:1.15rem; outline:none}

/* sidebar */
aside{
  position:sticky; top:90px; align-self:start; height:fit-content;
  background:linear-gradient(180deg,rgba(255,255,255,.055),rgba(255,255,255,.03));
  border:1px solid var(--line); border-radius:16px; box-shadow:var(--shadow); padding:1rem .9rem
}
aside h3{margin:.2rem 0 .7rem; font-family:"Playfair Display",serif}
.toc a{display:block; text-decoration:none; color:var(--ink2); padding:.35rem .2rem; border-radius:.4rem; font-size:.95rem}
.toc a:hover{color:var(--ink)}
.toc a.active{color:#111; background:linear-gradient(90deg,var(--gold),#efd6a8)}
hr.sep{border:0; height:1px; background:linear-gradient(90deg,transparent,var(--line),transparent); margin:1rem 0}
.note{border:1px solid var(--line); border-radius:12px; padding:.7rem .75rem; margin:.5rem 0; background:rgba(255,255,255,.05)}
.note time{display:block; color:var(--muted); font-size:.85rem}
.note .del{margin-top:.4rem; padding:.25rem .55rem; border-radius:.5rem; border:1px solid var(--line); background:var(--glass); color:var(--ink); cursor:pointer}

/* quiz */
.quiz{margin-top:1.6rem; padding:1rem; border:1px solid var(--line); border-radius:14px; background:rgba(255,255,255,.04)}
.qitem{margin:1rem 0; padding:.8rem; border-radius:10px; border:1px solid rgba(255,255,255,.12)}
.qitem h4{margin:0 0 .5rem 0; font-family:"Playfair Display",serif}
.qchoices{display:grid; gap:.45rem}
.qchoices button{text-align:left; border:1px solid rgba(255,255,255,.18); background:rgba(255,255,255,.05); color:var(--ink); padding:.55rem .7rem; border-radius:.6rem; cursor:pointer}
.qchoices button.correct{border-color:#46d17d}
.qchoices button.wrong{border-color:#e07070}
.qfeedback{color:var(--ink2); margin-top:.4rem; font-size:.98rem}

/* nav links */
.nextrow{display:flex; gap:.6rem; flex-wrap:wrap; margin-top:1.3rem}
.nextrow a{text-decoration:none; color:var(--ink); border:1px solid rgba(255,255,255,.26); border-radius:.8rem; background:linear-gradient(90deg,rgba(202,163,107,.28),rgba(122,160,255,.22)); padding:.7rem 1rem}

/* reveal + footer */
.reveal{opacity:0; transform:translateY(24px); transition:opacity .9s, transform .9s}
.reveal.in{opacity:1; transform:none}
footer{padding:2rem 1rem; text-align:center; color:var(--muted); border-top:1px solid var(--line)}
</style>
</head>
<body>

<div class="frame" aria-hidden="true"></div>
<div id="progress"></div>

<header class="reveal in">
  <h1>Quantum Next</h1>
  <p class="subtitle">A calm step after the Toolkit. Start simple, add clear rules, then go deeper with steady checks and examples that you can repeat.</p>
</header>

<div class="main">
  <article id="article">

    <!-- HERO FIGURE -->
    <figure class="figure reveal">
      <img src="wavefunction.png" alt="Wavefunction aesthetic"/>
      <figcaption class="figcap">Probability lives in the square of the amplitude. The habit is to write it, normalize it, then check the limits.</figcaption>
    </figure>

    <!-- ORIENTATION -->
    <h2 id="orientation" class="reveal">Orientation</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q1">★ Highlight</button>
      <p id="q1" class="dropcap">
        This page continues the same pattern you already know. We write the state and the question in one sentence, then we choose the rule that connects them, then we check the final line in a limit where our intuition is strong. The point is not to memorize many special cases. The point is to build a routine that does not wobble when details change. If you can name the system boundary, track the units, and predict a simple limit, you already control most of the difficulty and the rest is practice. Think of what follows as a long lab notebook entry that you can read without rushing and that you can reuse when the topic shifts.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q2">★ Highlight</button>
      <p id="q2">
        Keep a short checklist near the margin. What is the minimum set of variables that answer the question. Which operator reports the thing you will read out at the end. What units must that answer carry. Which limit is easy to guess before any algebra. If a final expression disobeys the unit check or misbehaves in the easy limit, pause and repair the setup rather than hunting small algebra slips. This habit makes theory feel steady and makes your results easier to share and defend.
      </p>
    </div>

    <!-- AMPLITUDE TO PROBABILITY -->
    <h2 id="prob" class="reveal">From amplitude to probability</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q3">★ Highlight</button>
      <p id="q3" class="dropcap">
        The wave function \( \Psi(x,t) \) carries amplitudes. Measurable chances live in its squared size. Two lines show up in almost every problem:
        \[
          P(x,t) = |\Psi(x,t)|^2, \qquad \int_{-\infty}^{\infty} |\Psi(x,t)|^2\,dx = 1.
        \]
        The first is how a detector’s clicks are distributed. The second is normalization. When an answer seems strange, check these two steps first. A missing factor in the square or a normalization slip can tilt a whole page of work. Write them early, then carry them gently through the rest of the calculation.
      </p>
    </div>

    <details class="reveal"><summary>Worked example - two overlapping humps</summary>
      <p>
        Build a state from two equal narrow Gaussians centered at \(-a\) and \(+a\). If their phases match, the middle brightens. If their phases oppose, a notch appears between peaks. If the phase wanders from shot to shot, the cross term averages away and you see a simple sum. One sketch teaches a permanent lesson. Interference lives in the phase, not only in the height of each hump.
      </p>
    </details>

    <!-- TIME EVOLUTION -->
    <h2 id="time" class="reveal">Time evolution that does not panic you</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q4">★ Highlight</button>
      <p id="q4" class="dropcap">
        The time rule is compact:
        \[
          i\hbar\,\frac{\partial}{\partial t}\Psi(x,t) = \hat{H}\,\Psi(x,t).
        \]
        When the potential is steady in time, try \(\Psi(x,t) = \phi(x)\,e^{-iEt/\hbar}\). The time part becomes a simple phase and the space part \(\phi(x)\) solves a quieter standing wave condition. Even without a full solution, you can count nodes, set boundary behavior, and predict how energy shifts when length or mass changes. These quick checks protect you from getting lost in algebra and they transfer to many new cases.
      </p>
    </div>

    <details class="reveal"><summary>Worked example - particle in a box</summary>
      <p>
        A one dimensional box of length \(L\) with hard walls admits standing sines. Energies are
        \[
          E_n = \frac{n^2 \pi^2 \hbar^2}{2mL^2}, \quad n=1,2,\dots
        \]
        Two fast checks help. If \(L\) grows, levels crowd together. If mass grows, levels drop. Both match your picture of gentler confinement and heavier inertia. If your expression fails either test, fix the setup first and save time later.
      </p>
    </details>

    <!-- SUPERPOSITION -->
    <h2 id="super" class="reveal">Superposition that you can use without fear</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q5">★ Highlight</button>
      <p id="q5" class="dropcap">
        Superposition means you can add allowed states with complex weights and still have an allowed state. Write \( |\psi\rangle = c_1 |\psi_1\rangle + c_2 |\psi_2\rangle \) and remember that relative phase between the pieces decides interference. This is not a trick. It is your main tool for building useful wave packets and for reasoning about splits and recombines in interferometer style setups. The size of each piece matters, but the phase between pieces is where many patterns hide.
      </p>
    </div>

    <figure class="figure reveal">
      <img src="particle-duality.png" alt="Two-path interference visual"/>
      <figcaption class="figcap">Two clean paths add before you square. The cross term carries the relative phase that shifts the pattern.</figcaption>
    </figure>

    <!-- INTERFERENCE -->
    <h2 id="phase" class="reveal">Interference and the role of phase</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q6">★ Highlight</button>
      <p id="q6" class="dropcap">
        When two undisturbed paths meet, the total amplitude is a sum and the probability contains a cross term. That term depends on the phase difference, which is controlled by path length, refractive index, potentials, and time spent. Small changes there shift bright and dark regions here. That is the secret of precise metrology with interferometers and also the reason that even gentle coupling to the environment can wash a pattern away. If something learns which path was taken, even partly, the cross term fades and the picture softens.
      </p>
    </div>

    <!-- UNCERTAINTY -->
    <h2 id="unc" class="reveal">Uncertainty as a design choice not a flaw</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q7">★ Highlight</button>
      <p id="q7" class="dropcap">
        The spread in position and momentum comes from the structure of the theory. The compact limit
        \[
          \Delta x\,\Delta p \ge \frac{\hbar}{2}
        \]
        tells you how narrow one knob can be before the other must widen. A tight focus means a wide momentum spread and faster spreading in time. A colder cloud means a narrower momentum spread and slower drift. You can trade one kind of precision for another on purpose and plan your setup rather than fight the limit after the fact.
      </p>
    </div>

    <!-- TUNNELING -->
    <h2 id="tunnel" class="reveal">Barriers, leakage, and tunneling you can picture</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q8">★ Highlight</button>
      <p id="q8" class="dropcap">
        Classical motion stops at a wall when the energy is too low. Quantum motion allows a small chance to appear beyond the wall if it is thin enough or if the particle is light enough. Inside the barrier the amplitude decays but does not die instantly and a faint tail emerges at the far side. This already explains scanning tunneling microscopes, tunneling diodes, and alpha decay. The trend lines are safe to remember. Thicker barriers and heavier masses suppress the chance. Lower barriers and lighter masses enhance it.
      </p>
    </div>

    <!-- SPIN -->
    <h2 id="spin" class="reveal">Spin as a clean two state system</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q9">★ Highlight</button>
      <p id="q9" class="dropcap">
        Spin is not a tiny top. It is an intrinsic two state structure that behaves like a vector of operators. The Stern Gerlach chain shows three rules that you can reuse often. Outcomes can be discrete. Measuring along a new axis erases certainty from the old axis. Repeating the same axis restores it. With \( |\psi\rangle = \alpha |{\uparrow}_z\rangle + \beta |{\downarrow}_z\rangle \) you can already predict how a rotated device changes counts without long algebra.
      </p>
    </div>

    <!-- EXPECTATION -->
    <h2 id="expect" class="reveal">Expectation values in one clean line</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q10">★ Highlight</button>
      <p id="q10" class="dropcap">
        The average outcome over many runs is
        \[
          \langle A \rangle = \int \Psi^*(x,t)\,\hat{A}\,\Psi(x,t)\,dx = \langle \psi | \hat{A} | \psi \rangle.
        \]
        Use whichever form makes the units and symmetries easier to inspect. If the operator measures a length, the final expression must carry length. If a supposed invariant flips sign when you change frames or rotate, something in the setup is off. These quick inspections save hours and make your notes readable later.
      </p>
    </div>

    <!-- ENTANGLEMENT -->
    <h2 id="ent" class="reveal">Entanglement without mystique</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q11">★ Highlight</button>
      <p id="q11" class="dropcap">
        Some states cannot be split into parts. A compact two qubit example is
        \[
          \frac{1}{\sqrt{2}}\big(|00\rangle + |11\rangle\big).
        \]
        No single product \( |a\rangle \otimes |b\rangle \) reproduces the perfect link between outcomes. This is not a signal that outruns light. It is a correlation set at preparation and revealed by what you choose to ask. The safe practice is to treat the pair as one system first and describe a part later by tracing over what you ignore.
      </p>
    </div>

    <figure class="figure reveal">
      <img src="quantum-field.png" alt="Abstract quantum field visual"/>
      <figcaption class="figcap">Fields give a value to every point in space and time. Boundaries and symmetry pick which shapes survive.</figcaption>
    </figure>

    <!-- MEASUREMENT -->
    <h2 id="meas" class="reveal">Measurement and why fringes fade when records exist</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q12">★ Highlight</button>
      <p id="q12" class="dropcap">
        A projective measurement is the sharp ideal. Real labs have coupling to surroundings. When the environment keeps a reliable record of which path was taken, the cross terms in the reduced description shrink and the contrast of interference falls. You did not break a rule. You changed the conditions needed for phases to add. The practical lesson is short. Isolation and speed preserve interference. Coupling and delay erase it.
      </p>
    </div>

    <!-- APPLICATIONS -->
    <h2 id="apps" class="reveal">From quiet rules to working devices</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q13">★ Highlight</button>
      <p id="q13" class="dropcap">
        The same small kit drives many tools. Band structure is a standing wave story in a periodic crystal and explains semiconductors. Lasers use controlled emission between energy levels with phase locked gain. MRI uses spin in fields with resonant pulses and gradients to map position. Quantum sensors use trade offs from uncertainty and interference to make tiny effects visible. None of this needs drama. It needs clear states, honest approximations, and clean checks written next to the final line.
      </p>
    </div>

    <!-- PRACTICE -->
    <h2 id="practice" class="reveal">Practice prompts you can finish on one page</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="q14">★ Highlight</button>
      <p id="q14" class="dropcap">
        Normalize a Gaussian and compute its width, then predict how that width grows in free motion and confirm with a short sketch. Draw the first three standing waves in a box and explain node locations from the boundary. Estimate how tunneling chance changes when barrier thickness doubles at fixed energy and mass. Model a Stern Gerlach chain with the middle magnet rotated and predict the three outputs. Compute one expectation value by integral and by bra ket and confirm the match to build trust in both forms.
      </p>
    </div>

    <!-- GLOSSARY -->
    <h2 id="glossary" class="reveal">Glossary - quick refresh</h2>
    <div class="divider"></div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="g1">★ Highlight</button>
      <p id="g1" class="dropcap">
        <strong>Wave function \( \Psi \)</strong> - Complex field of amplitudes whose squared size gives probability density. Normalize so total chance is one. Treat it as a calculator for chances, not as a material wave.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="g2">★ Highlight</button>
      <p id="g2">
        <strong>Hamiltonian \( \hat{H} \)</strong> - Energy operator that drives time evolution through \( i\hbar\,\partial_t\Psi=\hat{H}\Psi \). Build it from kinetic and potential parts in coordinates that match the boundary.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="g3">★ Highlight</button>
      <p id="g3">
        <strong>Operator</strong> - Rule that turns one state into another. Measuring means applying a specific operator and reporting one of its eigenvalues. Unit checks and symmetry checks expose mistakes early.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="g4">★ Highlight</button>
      <p id="g4">
        <strong>Expectation \( \langle A \rangle \)</strong> - Average outcome across identical trials. Use \( \int \Psi^* \hat{A} \Psi\,dx \) or \( \langle \psi | \hat{A} | \psi \rangle \). Pick the form that makes units easier to inspect.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="g5">★ Highlight</button>
      <p id="g5">
        <strong>Superposition</strong> - Legitimate state formed by adding states with complex weights. Relative phase sets interference. Size matters, phase decides pattern.
      </p>
    </div>

    <div class="pwrap reveal">
      <button class="hlbtn" data-target="g6">★ Highlight</button>
      <p id="g6">
        <strong>Entanglement</strong> - Correlation so strong that the parts require the whole. Treat the pair first. Describe parts by tracing over what you ignore.
      </p>
    </div>

    <!-- QUIZ -->
    <h2 id="quiz" class="reveal">Short quiz</h2>
    <div class="divider"></div>

    <section class="quiz reveal" id="quizSection">
      <div class="qitem">
        <h4>1) The meaning of \( |\Psi(x,t)|^2 \) is</h4>
        <div class="qchoices" data-answer="b" data-explain="It is a probability density. Integrate over a region to get the chance to find the particle there.">
          <button data-choice="a">Energy density at x</button>
          <button data-choice="b">Probability density at x</button>
          <button data-choice="c">Momentum distribution</button>
        </div><div class="qfeedback"></div>
      </div>

      <div class="qitem">
        <h4>2) With a time independent potential a good first move is</h4>
        <div class="qchoices" data-answer="a" data-explain="Try a separable form which turns time evolution into a simple phase.">
          <button data-choice="a">\(\Psi(x,t)=\phi(x)e^{-iEt/\hbar}\)</button>
          <button data-choice="b">Assume energy grows in time</button>
          <button data-choice="c">Ignore boundaries</button>
        </div><div class="qfeedback"></div>
      </div>

      <div class="qitem">
        <h4>3) The uncertainty relation teaches that</h4>
        <div class="qchoices" data-answer="c" data-explain="Tight position control forces a wider momentum spread.">
          <button data-choice="a">Better tools remove all spread</button>
          <button data-choice="b">Only momentum is uncertain</button>
          <button data-choice="c">Narrowing Δx widens Δp</button>
        </div><div class="qfeedback"></div>
      </div>

      <div class="qitem">
        <h4>4) A fast check on box energies is</h4>
        <div class="qchoices" data-answer="b" data-explain="As L grows, levels compress. If your expression misses that, recheck your algebra.">
          <button data-choice="a">Make mass smaller to lower energies</button>
          <button data-choice="b">Let L grow and see levels move closer</button>
          <button data-choice="c">Ignore units and compare shapes</button>
        </div><div class="qfeedback"></div>
      </div>

      <div class="qitem">
        <h4>5) An entangled two qubit state is one that</h4>
        <div class="qchoices" data-answer="a" data-explain="It cannot be written as a product of a state of A and a state of B.">
          <button data-choice="a">Does not factor into product states</button>
          <button data-choice="b">Always yields equal outcomes</button>
          <button data-choice="c">Has zero probability everywhere</button>
        </div><div class="qfeedback"></div>
      </div>

      <div style="margin-top:.8rem">
        <button id="gradeBtn" style="border:1px solid rgba(255,255,255,.3); background:rgba(255,255,255,.08); color:var(--ink); padding:.6rem 1rem; border-radius:.6rem; cursor:pointer">Grade quiz</button>
        <span id="scoreLine" style="margin-left:.8rem; color:var(--ink2)"></span>
      </div>
    </section>

    <!-- NAV ROW -->
    <div class="nextrow reveal">
      <a href="quantum_toolkit.html">← Back to Quantum Toolkit</a>
      <a href="theoretical.html">Back to Theoretical Hub</a>
      <a href="quantum_experiments.html">Next: Quantum Experiments →</a>
    </div>

  </article>

  <aside class="reveal">
    <h3>Contents</h3>
    <div id="toc" class="toc"></div>
    <hr class="sep"/>

    <h3>Notebook</h3>
    <p style="color:var(--ink2); margin:.1rem 0 .6rem">Click ★ next to any paragraph to save it here. Add your own note below.</p>
    <div id="nbList"></div>

    <textarea id="freeNote" placeholder="Write your own note. Press Save to store it." style="margin-top:.6rem; height:100px; background:rgba(255,255,255,.05); border:1px solid var(--line); color:var(--ink); border-radius:.5rem; padding:.55rem .6rem; font-family:'Crimson Text',serif;"></textarea>
    <div style="display:flex; gap:.5rem; margin-top:.4rem">
      <button id="saveFree" style="padding:.45rem .7rem; border-radius:.6rem; border:1px solid var(--line); background:var(--glass); color:var(--ink); cursor:pointer">Save</button>
      <button id="clearAll" style="padding:.45rem .7rem; border-radius:.6rem; border:1px solid var(--line); background:var(--glass); color:var(--ink); cursor:pointer">Clear all</button>
    </div>
    <p style="color:var(--muted); font-size:.9rem; margin-top:.4rem">Notes are saved in this browser.</p>
  </aside>
</div>

<footer>© 2025 QParadox</footer>

<script>
/* progress bar */
const bar=document.getElementById('progress');
function onScroll(){
  const h=document.documentElement, st=h.scrollTop||document.body.scrollTop, sh=h.scrollHeight-h.clientHeight;
  bar.style.width=(Math.max(0,Math.min(1,st/sh))*100)+'%';
}
addEventListener('scroll', onScroll); onScroll();

/* reveal */
const obs=new IntersectionObserver(es=>{ es.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('in'); obs.unobserve(e.target);} }); },{threshold:.18});
document.querySelectorAll('.reveal').forEach(el=>{ if(!el.classList.contains('in')) obs.observe(el); });

/* TOC */
const toc=document.getElementById('toc');
const heads=[...document.querySelectorAll('#article h2')];
heads.forEach(h=>{ const a=document.createElement('a'); a.href='#'+h.id; a.textContent=h.textContent; toc.appendChild(a); });
function spy(){
  const y=scrollY+140; let idx=-1;
  heads.forEach((s,i)=>{ if(s.offsetTop<=y && s.offsetTop+s.offsetHeight>y) idx=i; });
  [...toc.querySelectorAll('a')].forEach((a,i)=>a.classList.toggle('active',i===idx));
}
addEventListener('scroll', spy); spy();

/* notebook store - unique key for this page */
const KEY='qpx_notes_quantum_next_v2';
const listEl=document.getElementById('nbList');
function load(){ try{return JSON.parse(localStorage.getItem(KEY)||'[]');}catch(e){return [];} }
function save(data){ localStorage.setItem(KEY, JSON.stringify(data)); }
function render(){
  const notes=load(); listEl.innerHTML='';
  if(notes.length===0){ listEl.innerHTML='<p style="color:var(--muted)">No notes yet.</p>'; return; }
  notes.forEach(n=>{
    const div=document.createElement('div'); div.className='note'; div.dataset.id=n.id;
    div.innerHTML=`<time>${new Date(n.time).toLocaleString()}</time>
      <p>${n.text}</p>
      <button class="del">Remove</button>`;
    listEl.appendChild(div);
  });
}
render();

/* paragraph highlight save */
document.querySelectorAll('.hlbtn').forEach(btn=>{
  btn.addEventListener('click',()=>{
    const id=btn.dataset.target, p=document.getElementById(id);
    if(!p) return;
    p.classList.add('mark');
    const notes=load(); notes.push({id:'n'+Date.now(), text:p.textContent.trim(), time:Date.now(), para:id});
    save(notes); render();
  });
});

/* free note save & clear */
document.getElementById('saveFree').addEventListener('click',()=>{
  const box=document.getElementById('freeNote'); const t=box.value.trim(); if(!t) return;
  const notes=load(); notes.push({id:'n'+Date.now(), text:t, time:Date.now(), para:null});
  save(notes); render(); box.value='';
});
listEl.addEventListener('click',e=>{
  if(!e.target.classList.contains('del')) return;
  const item=e.target.closest('.note'); const id=item.dataset.id;
  const notes=load().filter(x=>x.id!==id); save(notes); render();
});
document.getElementById('clearAll').addEventListener('click',()=>{
  if(!confirm('Clear all saved notes for this page')) return;
  localStorage.removeItem(KEY); render();
  document.querySelectorAll('.mark').forEach(m=>m.classList.remove('mark'));
});

/* quiz grading */
const gradeBtn=document.getElementById('gradeBtn');
if(gradeBtn){
  document.querySelectorAll('.qchoices button').forEach(btn=>{
    btn.addEventListener('click',()=>{
      const group=btn.closest('.qchoices');
      group.querySelectorAll('button').forEach(b=>{ b.dataset.pressed='0'; b.classList.remove('correct','wrong'); });
      btn.dataset.pressed='1';
      const fb=group.parentElement.querySelector('.qfeedback');
      fb.textContent='Selection saved. Press Grade quiz when ready.';
      fb.style.color='#d1d1d1';
    });
  });
  gradeBtn.addEventListener('click',()=>{
    let score=0, total=0;
    document.querySelectorAll('.qchoices').forEach(group=>{
      total++;
      const ans=group.dataset.answer;
      const explain=group.dataset.explain||'';
      const fb=group.parentElement.querySelector('.qfeedback');
      const choice=[...group.querySelectorAll('button')].find(b=>b.dataset.pressed==='1');
      if(!choice){
        fb.textContent='Select an option to see feedback.'; fb.style.color='#f0d28a'; return;
      }
      if(choice.dataset.choice===ans){
        score++; choice.classList.add('correct'); fb.textContent='Correct - ' + explain; fb.style.color='#8fe0a8';
      }else{
        choice.classList.add('wrong'); fb.textContent='Not quite - ' + explain; fb.style.color='#f29b9b';
        const corr=[...group.querySelectorAll('button')].find(b=>b.dataset.choice===ans);
        if(corr) corr.classList.add('correct');
      }
    });
    const scoreLine=document.getElementById('scoreLine');
    if(scoreLine) scoreLine.textContent='Score: ' + score + ' / ' + total;
  });
}
</script>
</body>
</html>
